---
title: "Google Sheets"
description: "Verify emails in Google Sheets using Bolt Route."
---

## What you will build
Use a custom function to verify single emails in a sheet and a menu action to submit batch verification tasks.

## Step 1: Create your Bolt Route API key
1. Create an account or log in to Bolt Route.
2. Open [app.boltroute.ai/api](https://app.boltroute.ai/api).
3. Click **New key**.
4. In the **Generate API key** dialog, select **Google Sheets** to tag usage. Keys are universal, so the selection only tags usage.
5. Enter a key name, then click **Create key**.
6. Copy the key now. It is shown only once.

## Step 2: Realtime verification in Google Sheets
1. Open your spreadsheet.
2. Go to **Extensions** -> **Apps Script**.
3. Replace the default code with the script below.
4. In **Project Settings**, add a script property named `BOLTROUTE_API_KEY` and paste your key as the value.
5. Save, then run `BOLTVERIFY` once in the Apps Script editor to authorize.
6. Back in the sheet, use `=BOLTVERIFY(A2)` to return the `status` for the email in `A2`. You can also pass a field name like `=BOLTVERIFY(A2, "is_disposable")`.

```js
const API_BASE = 'https://api.boltroute.ai';

function getApiKey_() {
  const key = PropertiesService.getScriptProperties().getProperty('BOLTROUTE_API_KEY');
  if (!key) throw new Error('Missing BOLTROUTE_API_KEY in Script Properties.');
  return key;
}

function BOLTVERIFY(email, field) {
  if (!email) return '';
  const payload = JSON.stringify({ email: email });
  const response = UrlFetchApp.fetch(`${API_BASE}/api/v1/verify`, {
    method: 'post',
    contentType: 'application/json',
    headers: { Authorization: `Bearer ${getApiKey_()}` },
    payload: payload,
    muteHttpExceptions: true,
  });

  const data = JSON.parse(response.getContentText());
  if (field) return data[field] ?? '';
  return data.status ?? '';
}

function onOpen() {
  SpreadsheetApp.getUi()
    .createMenu('Bolt Route')
    .addItem('Create batch task from selection', 'boltCreateBatchFromSelection')
    .addToUi();
}

function boltCreateBatchFromSelection() {
  const range = SpreadsheetApp.getActiveRange();
  const emails = range.getValues().flat().map(String).map(s => s.trim()).filter(Boolean);
  if (!emails.length) {
    SpreadsheetApp.getUi().alert('Select at least one email address.');
    return;
  }

  const response = UrlFetchApp.fetch(`${API_BASE}/api/v1/tasks`, {
    method: 'post',
    contentType: 'application/json',
    headers: { Authorization: `Bearer ${getApiKey_()}` },
    payload: JSON.stringify({ emails: emails }),
    muteHttpExceptions: true,
  });

  const data = JSON.parse(response.getContentText());
  SpreadsheetApp.getUi().alert(`Batch task created: ${data.id}`);
}
```

## Step 3: Batch verification in Google Sheets
1. Select the range of emails you want to verify.
2. Use **Bolt Route** -> **Create batch task from selection**.
3. Copy the task `id` from the confirmation dialog.
4. Use it with [Get task](/api-reference/endpoints/batch-verification/get-task) or [Download results](/api-reference/endpoints/batch-verification/download-results).

<Note>
Replace `https://api.boltroute.ai` with your Bolt Route API base URL if different.
</Note>
